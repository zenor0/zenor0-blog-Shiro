function d(t,s,e,r=!1){return{name:t,code(n){const i=n.children.filter(o=>o.type==="element"),c=[];i.forEach((o,h)=>{let u;for(const a of o.children){if(a.type!=="element")continue;const l=a.children[0];if(l.type!=="text")continue;let f=!1;l.value=l.value.replace(s,(...m)=>e.call(this,m,o,a,i,h)?(f=!0,""):m[0]),f&&!l.value.trim()&&(u=a)}if(u&&(o.children.splice(o.children.indexOf(u),1),o.children.length===0&&(c.push(o),r))){const a=n.children[n.children.indexOf(o)+1];a&&a.type==="text"&&a.value===`
`&&c.push(a)}});for(const o of c)n.children.splice(n.children.indexOf(o),1)}}}function x(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(t={},s="@shikijs/transformers:notation-map"){const{classMap:e={},classActivePre:r=void 0}=t;return d(s,new RegExp(`\\s*(?://|/\\*|<!--|#)\\s+\\[!code (${Object.keys(e).map(x).join("|")})(:\\d+)?\\]\\s*(?:\\*/|-->)?`),function([n,i,c=":1"],o,h,u,a){const l=Number.parseInt(c.slice(1),10);return u.slice(a,a+l).forEach(f=>{this.addClassToHast(f,e[i])}),r&&this.addClassToHast(this.pre,r),!0})}function N(t={}){const{classActiveLine:s="highlighted",classActivePre:e="has-highlighted"}=t;return g({classMap:{highlight:s,hl:s},classActivePre:e},"@shikijs/transformers:notation-highlight")}function y(t,s,e,r){const n=v(t);let i=n.indexOf(e);for(;i!==-1;)_.call(this,t.children,s,i,e.length,r),i=n.indexOf(e,i+1)}function v(t){return t.type==="text"?t.value:t.type==="element"&&t.tagName==="span"?t.children.map(v).join(""):""}function _(t,s,e,r,n){let i=0;for(let c=0;c<t.length;c++){const o=t[c];if(o.type!=="element"||o.tagName!=="span"||o===s)continue;const h=o.children[0];if(h.type==="text"){if(j([i,i+h.value.length-1],[e,e+r])){const u=Math.max(0,e-i),a=r-Math.max(0,i-e);if(a===0)continue;const l=k(o,h,u,a);this.addClassToHast(l[1],n);const f=l.filter(Boolean);t.splice(c,1,...f),c+=f.length-1}i+=h.value.length}}}function j(t,s){return t[0]<=s[1]&&t[1]>=s[0]}function k(t,s,e,r){const n=s.value,i=c=>H(t,{children:[{type:"text",value:c}]});return[e>0?i(n.slice(0,e)):void 0,i(n.slice(e,e+r)),e+r<n.length?i(n.slice(e+r)):void 0]}function H(t,s){return{...t,properties:{...t.properties},...s}}function T(t={}){const{classActiveWord:s="highlighted-word",classActivePre:e=void 0}=t;return d("@shikijs/transformers:notation-highlight-word",/^\s*(?:\/\/|\/\*|<!--|#)\s+\[!code word:((?:\\.|[^:\]])+)(:\d+)?\]\s*(?:\*\/|-->)?/,function([r,n,i],c,o,h,u){const a=i?Number.parseInt(i.slice(1),10):h.length;return n=n.replace(/\\(.)/g,"$1"),h.slice(u+1,u+1+a).forEach(l=>y.call(this,l,o,n,s)),e&&this.addClassToHast(this.pre,e),!0},!0)}function b(t={}){const{classLineAdd:s="diff add",classLineRemove:e="diff remove",classActivePre:r="has-diff"}=t;return g({classMap:{"++":s,"--":e},classActivePre:r},"@shikijs/transformers:notation-diff")}function A(t){if(!t)return null;const s=t.match(/{([\d,-]+)}/);return s?s[1].split(",").flatMap(r=>{const n=r.split("-").map(i=>Number.parseInt(i,10));return n.length===1?[n[0]]:Array.from({length:n[1]-n[0]+1},(i,c)=>c+n[0])}):null}const p=Symbol("highlighted-lines");function M(t={}){const{className:s="highlighted"}=t;return{name:"@shikijs/transformers:meta-highlight",line(e,r){var n;return this.options.meta?.__raw?((n=this.meta)[p]||(n[p]=A(this.options.meta.__raw)),(this.meta[p]||[]).includes(r)&&this.addClassToHast(e,s),e):void 0}}}function C(t,{lang:s,attrs:e,code:r}){const n={lang:s,meta:{__raw:e},themes:{light:"github-light",dark:"github-dark"}};return t.codeToHtml(r,{...n,transformers:[...n.transformers||[],b(),N(),T(),M()]})}const O=t=>{const s=t.match(/filename="([^"]+)"/);return s?s[1]:null},w=t=>["javascript","typescript","ts","js","css","tsx","jsx","json","sql","markdown","vue","rust","go","cpp","c","html","asm","bash","ps","ps1","text","plaintext","txt","plain"].includes(t.toLowerCase());export{C as c,w as i,O as p};
